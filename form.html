<!DOCTYPE html>
<html>
  <head>
    <script lang="javascript">
      var data = JSON.stringify({"grant_type":"client_credentials","client_id":"30gauksoac38g95wm92tps98","client_secret":"Wmems8uxInahKenBIjVyGKwf","scope":"email_read email_write email_send data_extensions_write data_extensions_read list_and_subscribers_write list_and_subscribers_read","account_id":"100007110"});

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;
xhr.addEventListener("readystatechange", function() {
  if(this.readyState === 4) {
    console.log(this.responseText);
  }
});

xhr.open("POST", "https://mc4zjl56xtv07dhwl37nkhdwq8gq.auth.marketingcloudapis.com/v2/token");
xhr.setRequestHeader("Content-Type", "application/json");
      xhr.setRequestHeader("Access-Control-Allow-Origin", "*");

xhr.send(data);

console.log(data);

// FINE

var data = JSON.stringify({"definitionKey":"Test Optin CDT 03","status":"Active","name":"Unique Def - Test Optin CDT 3","description":"Created via REST POSTMAN","classification":"Default Transactional","content":{"customerKey":"f5ed5072-a30c-44ff-bf5d-ada49d541d8a"},"subscriptions":{"list":"All Subscribers - 2069","dataExtension":"D03ED87A-B693-4D9E-B9BD-8A30F0B713D4","autoAddSubscriber":true,"updateSubscriber":true},"options":{"trackLinks":true}});

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener("readystatechange", function() {
  if(this.readyState === 4) {
    console.log(this.responseText);
  }
});

xhr.open("POST", "https://mc4zjl56xtv07dhwl37nkhdwq8gq.rest.marketingcloudapis.com/messaging/v1/email/definitions");
xhr.setRequestHeader("Authorization", "Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6IjEiLCJ2ZXIiOiIxIiwidHlwIjoiSldUIn0.eyJhY2Nlc3NfdG9rZW4iOiJaV2poNzhZS1JuQlZrbjFlMXRNQzEwSUMiLCJjbGllbnRfaWQiOiIzMGdhdWtzb2FjMzhnOTV3bTkydHBzOTgiLCJlaWQiOjEwMDAwNzExMCwic3RhY2tfa2V5IjoiUzEwIiwicGxhdGZvcm1fdmVyc2lvbiI6MiwiY2xpZW50X3R5cGUiOiJTZXJ2ZXJUb1NlcnZlciJ9.oMxBezyiLKX-WG_e3b84eO4DYWFfRra1TTYpQnfcZAA.XlMCUMdm84h-u4wR7JV3coN91F9GyczB4UE_PnI77_Cg-UjpqaV5LfomjzfK8O8IS8qmCtm8MZWGQW-FJrUWQsyccPJMjsjdBKdlHzmV9_BSN_KnleQW5MizYmg29AZEEE1qLn_9u7wByAYxVhJc8Ul-M-_Cbq3nhYwqmSxgpw-hIA7rKsl");
xhr.setRequestHeader("Content-Type", "application/json");

xhr.send(data);

console.log(data);

// FINE

var data = JSON.stringify({"definitionKey":"Test Optin CDT 03","recipient":{"contactKey":"federico.megna@noovle.com","to":"federico.megna@noovle.com","attributes":{"FirstName":"Federico","LastName":"Megna","OptIn":"{{currentDate}}"}}});

var xhr = new XMLHttpRequest();
xhr.withCredentials = true;

xhr.addEventListener("readystatechange", function() {
  if(this.readyState === 4) {
    console.log(this.responseText);
  }
});

xhr.open("POST", "https://mc4zjl56xtv07dhwl37nkhdwq8gq.rest.marketingcloudapis.com/messaging/v1/email/messages/b7de2d87-3a1c-4cda-afb0-6ac299594d12");
xhr.setRequestHeader("Authorization", "Bearer eyJhbGciOiJIUzI1NiIsImtpZCI6IjEiLCJ2ZXIiOiIxIiwidHlwIjoiSldUIn0.eyJhY2Nlc3NfdG9rZW4iOiJaV2poNzhZS1JuQlZrbjFlMXRNQzEwSUMiLCJjbGllbnRfaWQiOiIzMGdhdWtzb2FjMzhnOTV3bTkydHBzOTgiLCJlaWQiOjEwMDAwNzExMCwic3RhY2tfa2V5IjoiUzEwIiwicGxhdGZvcm1fdmVyc2lvbiI6MiwiY2xpZW50X3R5cGUiOiJTZXJ2ZXJUb1NlcnZlciJ9.oMxBezyiLKX-WG_e3b84eO4DYWFfRra1TTYpQnfcZAA.XlMCUMdm84h-u4wR7JV3coN91F9GyczB4UE_PnI77_Cg-UjpqaV5LfomjzfK8O8IS8qmCtm8MZWGQW-FJrUWQsyccPJMjsjdBKdlHzmV9_BSN_KnleQW5MizYmg29AZEEE1qLn_9u7wByAYxVhJc8Ul-M-_Cbq3nhYwqmSxgpw-hIA7rKsl");
xhr.setRequestHeader("Content-Type", "application/json");

xhr.send(data);

console.log(data);

// FINE
    </script>
  </head>
<body>

<h2>Matteo Quick Form</h2>

<form action="/action_page.php">
  <label for="fname">First name:</label><br>
  <input type="text" id="fname" name="fname" value="first name here"><br>
  
  <label for="lname">Last name:</label><br>
  <input type="text" id="lname" name="lname" value="last name here"><br><br>
  
  <label for="email">Email:</label><br>
  <input type="text" id="email" name="email" value="email"><br><br>
  
  <input type="hidden" id="accountNumber" name="accountNumber" value="***"><br><br>
  
  <input type="submit" value="Submit">
</form> 

</body>
</html>

